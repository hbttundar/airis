<VirtualHost *:443>
    Timeout 200
    
    ServerName www.indra.localhost

    ServerAlias www.indra.de.localhost
    ServerAlias www.stage.indra.de
    ServerAlias www.live.indra.de
    ServerAlias www.indra.de

    ProxyRequests Off
    ProxyPreserveHost On
    ProxyVia Full
    ProxyPass / http://web/
    ProxyPassReverse / http://web/

    RequestHeader set X-Forwarded-Proto "https"
    RequestHeader set X-Forwarded-Port "443"

    <If "%{HTTP_HOST} =~ /^(.*)\.localhost/">
        SetEnvIf Host "^(.*)\.localhost" proxy_pass_host=$1
        RequestHeader set Host "%{proxy_pass_host}e"
    </If>

</VirtualHost>